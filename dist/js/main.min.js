const data={},sortSettings={field:"price",ascending:!1},filterSettings={fields:["isNew"]},cart={};function initPage(){function t(){!function(){const t=document.querySelector(".overlay"),e=document.querySelector(".catalog__sort-list");t.classList.remove("active"),e.classList.remove("active"),document.querySelector("body").classList.remove("blocked"),e.removeAttribute("style")}(),function(){const t=document.querySelector(".overlay"),e=document.querySelector(".cart");document.querySelector("body").classList.remove("blocked"),t.classList.remove("active"),e.classList.remove("active")}(),function(){const t=document.querySelector(".catalog__col"),e=document.querySelector(".overlay");t.classList.remove("active"),e.classList.remove("active"),document.querySelector("body").classList.remove("blocked")}()}new Swiper(".banner__slider",{direction:"horizontal",loop:!0,spaceBetween:0,pagination:{el:".banner__slider-pagination",clickable:!0},navigation:{nextEl:".banner__button-next",prevEl:".banner__button-prev"}}),document.querySelectorAll(".catalog__filter").forEach((t=>{t.addEventListener("click",(()=>{t.classList.toggle("active"),t.classList.contains("active")?filterSettings.fields.push(t.getAttribute("data-filter")):filterSettings.fields=filterSettings.fields.filter((e=>e!=t.getAttribute("data-filter"))),makeFilteredList()}))})),document.querySelector(".catalog__sort-current").addEventListener("click",(function(){const t=document.querySelector(".catalog__sort-list"),e=document.querySelector(".overlay"),c=document.querySelector(".catalog__sort-current").getBoundingClientRect();t.classList.add("active"),t.style.top=`${c.top}px`,t.style.right=window.innerWidth-c.right+"px",document.querySelector("body").classList.add("blocked"),e.classList.add("active")})),function(){const e=document.querySelector(".header__cartBtn"),c=document.querySelector(".cart__close");e.addEventListener("click",(function(){const t=document.querySelector(".overlay"),e=document.querySelector(".cart");document.querySelector("body").classList.add("blocked"),t.classList.add("active"),e.classList.add("active")})),c.addEventListener("click",t)}(),document.querySelector(".overlay").addEventListener("click",t),function(){const t=document.querySelector(".header__burger"),e=document.querySelector(".header__menu");t.addEventListener("click",(()=>{t.classList.toggle("active"),e.classList.toggle("active")}))}(),document.querySelector(".catalog__filterBtn").addEventListener("click",(function(){document.querySelector(".catalog__col").classList.add("active"),document.querySelector(".overlay").classList.add("active"),document.querySelector("body").classList.add("blocked")})),document.querySelectorAll(".catalog__sort-type").forEach((t=>{t.addEventListener("click",(()=>{t.classList.contains("active")||(document.querySelector(".catalog__sort-type.active").classList.remove("active"),sortSettings.field=t.getAttribute("data-sorting-field"),sortSettings.ascending="asc"==t.getAttribute("data-sort-dir"),t.classList.add("active"),makeSortedList())}))})),initCartBtns(),function(){const t=document.querySelector(".catalog__list");t.addEventListener("click",(t=>{t.target;var e;t.target.closest(".card__btn")&&(e=t.target.closest(".card").getAttribute("data-id"),cart[e]=cart[e]?cart[e]+1:1,renderCart())}))}(),getData()}function getData(){axios.get("https://67376796aafa2ef22233b7c6.mockapi.io/mockapi/items").then((t=>{!function(t){let e={};t.forEach((t=>{e[t.id]=t,e[t.id].price=+e[t.id].price,e[t.id].image=`./images/catalog/Photo (${e[t.id].price%6}).jpg`})),data.idToDataMap=e,makeFilteredList(),renderCart()}(t.data)})).catch((t=>console.log(t)))}function renderCart(){const t=document.querySelector(".cart__list");t.innerHTML="";const e=(t,e)=>{const c=data.idToDataMap[t];return`<div class="cart-item" data-id="${t}">\n\t<div class="cart-item__img">\n\t\t<img src="${c.image}" alt="">\n\t</div>\n\t<div class="cart-item__content">\n\t\t<div class="cart-item__title">${c.title}</div>\n\t\t<div class="cart-item__sum">${c.price*e}</div>\n\t</div>\n\t<div class="cart-item__counter">\n\t\t<div class="cart-item__counter-btn minus">\n\t\t\t<img src="./images/minus.svg" alt="">\n\t\t</div>\n\t\t<div class="cart-item__counter-curent">${e}</div>\n\t\t<div class="cart-item__counter-btn plus">\n\t\t\t<img src="./images/plus (1).svg" alt="">\n\t\t</div>\n\t</div>\n\t<div class="cart-item__delete">\n\t\t<img src="./images/x.svg" alt="">\n\t</div>\n\t<div class="cart-item__return">\n\t\t<img src="./images/repeat.svg" alt="">\n\t</div>\n</div>`};for(let c in cart)t.innerHTML+=e(c,cart[c]);(()=>{const t=Object.keys(cart).length;let e=0;for(let t in cart)e+=data.idToDataMap[t].price*cart[t];document.querySelector(".header__cartBtn").innerHTML=t,document.querySelector(".cart__bottom-total").innerHTML=e,formatQuantity(".cart__total",t)})()}function makeFilteredList(){const t=[],e=filterSettings.fields,c=data.idToDataMap;for(let a in c)e.some((t=>!c[a][t]))||t.push(c[a]);data.filteredList=t,formatQuantity(".catalog__counter",t.length),makeSortedList()}function formatQuantity(t,e){document.querySelector(t).innerHTML=(t=>{const e=["товар","товара","товаров"],c=t%100,a=t%10;return c>4&&c<21?`${t} ${e[2]}`:1===a?`${t} ${e[0]}`:a>1&&a<5?`${t} ${e[1]}`:`${t} ${e[2]}`})(e)}function makeSortedList(){const t=[...data.filteredList].sort(((t,e)=>t.price-e.price));sortSettings.ascending||t.reverse(),data.sortedList=t,function(){const t=document.querySelector(".catalog__list");t.innerHTML="";data.sortedList.forEach((e=>{t.innerHTML+=(({id:t,title:e,image:c,price:a})=>`\n\t\t\t\t\t<div data-id="${t}" class="card">\n\t\t\t\t<div class="card__img">\n\t\t\t\t\t<img src="${c}" alt="" />\n\t\t\t\t</div>\n\t\t\t\t<div class="card__title">${e}</div>\n\t\t\t\t<div class="card__bottom">\n\t\t\t\t\t<div class="card__price">${a} ₽</div>\n\t\t\t\t\t<div class="card__btn">\n\t\t\t\t\t\t<img src="./images/plus.svg" alt="" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\n\t\t\t`)(e)}))}()}function initCartBtns(){const t=document.querySelector(".cart");t.addEventListener("click",(t=>{const e=t.target;var c;e.closest(".cart__clear")?(()=>{for(let t in cart)delete cart[t];renderCart()})():e.closest(".minus")?(c=e.closest(".cart-item").getAttribute("data-id"),cart[c]--,cart[c]||delete cart[c],renderCart()):e.closest(".plus")?(t=>{cart[t]++,renderCart()})(e.closest(".cart-item").getAttribute("data-id")):e.closest(".cart-item__delete")&&(t=>{delete cart[t],renderCart()})(e.closest(".cart-item").getAttribute("data-id"))}))}initPage();